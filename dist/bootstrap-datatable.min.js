!function(t){function a(a){var e=a.options;if("bool"==t(this).data("filterType")){t(this).is(":checked")?e.filter[t(this).data("filter")]=t(this).val():delete e.filter[t(this).data("filter")];r="";for(var o in e.filter)""!=r&&(r+="&"),r+=o+"="+encodeURIComponent(e.filter[o]);history.pushState(e.filter,"","?"+r),a.render()}else{e.filter[t(this).data("filter")]=t(this).val();var r="";for(var o in e.filter)""!=r&&(r+="&"),r+=o+"="+encodeURIComponent(e.filter[o]);history.pushState(e.filter,"","?"+r),a.render()}}var e=function(a,e){this.$element=t(a),this.options=e,this.enabled=!0,this.columns=[],this.rows=[],this.buttons=[],this.localStorageId="datatable_"+(e.id||e.url.replace(/\W/gi,"_"));for(var o in this.options.columns)void 0===typeof this.options.columns[o].sortable&&(this.options.columns[o].sortable=!0);this.$element.addClass("clearfix"),this.options.tablePreRender&&"function"==typeof this.options.tablePreRender&&this.options.tablePreRender.call(this),!0===this.options.autoLoad&&this.render()};e.prototype={constructor:e,render:function(){var a=this.options,e=this.$element;this.loading(!0),this.columns=[],this.rows=[],this.buttons=[],this.$wrapper=void 0,this.$table=void 0,this.$header=void 0,this.$body=void 0,this.$footer=void 0,this.$pagination=void 0,this.$top_details=t("<div></div>").addClass("dt-top-details"),this.$bottom_details=t("<div></div>").addClass("dt-bottom-details");var o,r=0;if(localStorage){var l=new Date,s=new Date(localStorage[this.localStorageId+".time"]);if(l.getTime()-s.getTime()>6e5){r=localStorage[this.localStorageId+".page"];try{o=JSON.parse(localStorage[this.localStorageId+".sort"])}catch(t){}}}r&&(a.currentPage=r),o&&(a.sort=o);var i=this;""!==a.url&&t.ajax({url:a.url,type:"POST",dataType:"json",data:t.extend({},a.post,{currentPage:a.currentPage,perPage:a.perPage,sort:a.sort,filtering:a.filter}),success:function(t){i.resultset=t,e.empty(),"ERROR"==t.Result?(console.log(t),e.append("An error has occurred."),i.loading(!1)):(a.sort=t.sort,a.filter=t.filter,a.totalRows=t.totalRows,t.currentPage&&(a.currentPage=parseInt(t.currentPage)),e.append(i.table()),e.prepend(i.$top_details),e.append(i.$bottom_details),a.showHeader&&i.header(),a.showFooter&&i.footer(),i.body(),a.showTopPagination&&i.pagination()&&i.$top_details.append(i.pagination().clone(!0)),a.showPagination&&i.pagination()&&i.$bottom_details.append(i.pagination().clone(!0)),i.details(),a.tableCallback&&"function"==typeof a.tableCallback&&a.tableCallback.call(i),i.fadeIn(),i.loading(!1))},error:function(t){a.debug&&console.log(t),function(){var t=this.options,a=this.$element;a.empty(),t.tableCallback&&"function"==typeof t.tableCallback&&t.tableCallback.call(this),this.loading(!1),this.$default&&a.append(this.$default)}.call(i),i.loading(!1)}})},loading:function(a){var e=this.$element;this.$loading||(this.$loading=t("<div></div>").css({position:"absolute",left:Math.floor(e.width()/4),width:Math.floor(e.width()/2)+"px"}).append(t("<div></div>").addClass("progress").append(t('<div role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div>').addClass("progress-bar progress-bar-primary progress-bar-striped active"))).appendTo(e.parent())),a?e.css({opacity:.2}):(e.css({opacity:1}),this.$loading.remove(),this.$loading=void 0)},details:function(){var a=this.options,e=(this.resultset,0),o=0;(e=a.currentPage*a.perPage-a.perPage+1)<1&&(e=1),(o=a.currentPage*a.perPage)>a.totalRows&&(o=a.totalRows),a.totalRows>0&&t('<div class="pull-left"><p>Showing '+e+" to "+o+" of "+a.totalRows+" "+a.rowsName+"</p></div>").prependTo(this.$bottom_details)},fadeIn:function(){var t=this.options;this.$wrapper.animate({opacity:1},t.tableFade)},table:function(){this.$element;var a=this.options;return this.$table_wrapper||(this.$wrapper=t("<div></div>").addClass("dt-table-wrapper table-responsive")),this.$table||(this.$table=t("<table></table>").addClass(a.class)),this.$wrapper.append(this.$table),this.$wrapper},header:function(){var a=this.options;this.resultset;if(!this.$header){this.$header=t("<thead></thead>");var e=t("<tr></tr>");for(var o in a.columns){var r=this.column(o),l=r.data("column_properties");l.sortable&&!l.custom&&r.click(this,this.sort).addClass("sortable");for(var s=0;s<a.sort.length;s++)a.sort[s][0]==l.field&&("asc"==a.sort[s][1]?(r.addClass("sorting-asc"),l.sortOrder="asc"):"desc"==a.sort[s][1]&&(r.addClass("sorting-desc"),l.sortOrder="desc"));e.append(r),this.$header.append(e),this.columns.push(r)}a.headerCallback&&"function"==typeof a.headerCallback&&a.headerCallback.call(this),this.$table.append(this.$header)}return this.$header},footer:function(){var a=this.options;this.resultset;if(!this.$footer){this.$footer=t("<tfoot></tfoot>");for(column in a.columns){var e=t("<td></td>");e.data("cell_properties",a.columns[column]).addClass(a.columns[column].classname),this.$footer.append(e)}a.footerCallback&&"function"==typeof a.footerCallback&&a.footerCallback.call(this,this.resultset.footer),this.$table.append(this.$footer)}return this.$footer},body:function(){var a=this.resultset,e=this.options;if(!this.$body){this.$body=t("<tbody></tbody>");for(var o=0;o<a.data.length;o++){var r=this.row(a.data[o]);this.$body.append(r),this.rows.push(r)}e.showFilterRow&&this.$body.prepend(this.filter()),this.$table.append(this.$body)}return this.$body},filter:function(){var e=t("<tr></tr>"),o=this.options,r=this;e.addClass("dt-filter-row");for(var l in o.columns){var s=t("<td></td>").addClass(o.columns[l].classname);if(o.columns[l].hidden&&s.hide(),o.columns[l].filter&&o.columns[l].field){var i=t('<input class="form-control input-sm input-xs input-filter" />').attr("name","filter_"+o.columns[l].field).data("filter",o.columns[l].field).val(o.filter[o.columns[l].field]||"").change(function(t){o.currentPage=1,localStorage&&(localStorage[r.localStorageId+".page"]=o.currentPage),a.call(this,r)});"bool"==o.columns[l].fieldType?i.attr("type","checkbox").data("filterType","bool").val("True").attr("checked","True"==o.filter[o.columns[l].field]):"lookup"==o.columns[l].fieldType?(i=t("<select/>").attr("name","filter_"+o.columns[l].field).data("filter",o.columns[l].field).change(function(t){o.currentPage=1,localStorage&&(localStorage[r.localStorageId+".page"]=o.currentPage),a.call(this,r)}),o.columns[l].fieldOptions.forEach(function(t){i.append('<option value="'+t.value+'" '+(o.filter[o.columns[l].field]===t.value?"selected":"")+">"+t.label+"</option>")},this)):i.attr("type","text"),s.append(i)}e.append(s)}return e},row:function(a){var e=t("<tr></tr>"),o=this.options;e.data("row_data",a);for(var r in o.columns){var l=this.cell(a,r);e.append(l)}return o.rowCallback&&"function"==typeof o.rowCallback&&(e=o.rowCallback(e,a)),e},cell:function(a,e){var o=a[this.options.columns[e].field],r=t("<td></td>"),l=this.options;return l.columns[e].callback&&"function"==typeof l.columns[e].callback&&(o=l.columns[e].callback.call(r,a,l.columns[e])),r.data("cell_properties",l.columns[e]).addClass(l.columns[e].classname).append(o),l.columns[e].customclass&&r.addClass(l.columns[e].customclass),l.columns[e].css&&r.css(l.columns[e].css),l.columns[e].hidden&&r.hide(),r},column:function(a){var e=t("<th></th>"),o=this.options,r="dt-column_"+a+Math.floor(1e3*Math.random()+1);return o.columns[a].classname=r,e.data("column_properties",o.columns[a]).addClass(r).text(o.columns[a].title),o.columns[a].customheaderclass&&e.addClass(o.columns[a].customheaderclass),o.columns[a].css&&e.css(o.columns[a].css),o.columns[a].hidden&&e.hide(),e},sort:function(a){var e=t(this).data("column_properties"),o=a.data,r=a.data.options,l=!1;if(e.sortOrder=e.sortOrder?"asc"==e.sortOrder?"desc":"":"asc",r.allowMultipleSort){for(var s=0;s<r.sort.length;s++)r.sort[s][0]==e.field&&(r.sort[s][1]=e.sortOrder,""===e.sortOrder&&r.sort.splice(s,1),l=!0);l||r.sort.push([e.field,e.sortOrder])}else r.sort=[],e.sortOrder&&r.sort.push([e.field,e.sortOrder]);localStorage&&(localStorage[o.localStorageId+".sort"]=JSON.stringify(r.sort)),r.currentPage=1,o.render()},pagination:function(){this.$element;var a=this,e=this.options,o=this.resultset;if(!(e.perPage>=o.totalRows)){if(!this.$pagination){this.$pagination=t("<div></div>").addClass("pull-right"),e.pageCount=Math.ceil(o.totalRows/e.perPage),localStorage&&(localStorage[a.localStorageId+".time"]=new Date);var r,l,s=t("<ul></ul>").addClass("pagination pagination-sm"),i=t("<li></li>").append(t("<a></a>").attr("href","#").data("page",1).html("&laquo;").click(function(){return e.currentPage=1,localStorage&&(localStorage[a.localStorageId+".page"]=e.currentPage),a.render(),!1})),n=t("<li></li>").append(t("<a></a>").attr("href","#").data("page",e.currentPage-1).html("&lt;").click(function(){return e.currentPage-=1,e.currentPage=e.currentPage>=1?e.currentPage:1,localStorage&&(localStorage[a.localStorageId+".page"]=e.currentPage),a.render(),!1})),d=t("<li></li>").append(t("<a></a>").attr("href","#").data("page",e.currentPage+1).html("&gt;").click(function(){return e.currentPage+=1,e.currentPage=e.currentPage<=e.pageCount?e.currentPage:e.pageCount,localStorage&&(localStorage[a.localStorageId+".page"]=e.currentPage),a.render(),!1})),c=t("<li></li>").append(t("<a></a>").attr("href","#").data("page",e.pageCount).html("&raquo;").click(function(){return e.currentPage=e.pageCount,localStorage&&(localStorage[a.localStorageId+".page"]=e.currentPage),a.render(),!1})),p=2*e.pagePadding;p>=e.pageCount?(r=1,l=e.pageCount):((r=e.currentPage-e.pagePadding)<=0&&(r=1),(l=r+p)>e.pageCount&&(r=(l=e.pageCount)-p));for(var u=r;u<=l;u++){var h=t("<li></li>").append(t("<a></a>").attr("href","#").data("page",u).text(u).click(function(){return e.currentPage=t(this).data("page"),localStorage&&(localStorage[a.localStorageId+".page"]=e.currentPage),a.render(),!1}));u==e.currentPage&&h.addClass("active"),s.append(h)}1==e.currentPage&&(i.addClass("disabled"),n.addClass("disabled")),e.currentPage==e.pageCount&&(d.addClass("disabled"),c.addClass("disabled")),s.prepend(i,n),s.append(d,c),this.$pagination.append(s)}return this.$pagination}},remove:function(){var t=this.$element;this.$section_header&&this.$section_header.remove(),t.data("datatable",null),t.empty()}},t.fn.datatable=function(a){return t.fn.datatable.init.call(this,a,e,"datatable"),this},t.fn.datatable.init=function(a,e,o){var r;return!0===a?this.data(o):"string"==typeof a?((r=this.data(o))&&r[a](),this):(a=t.extend({},t.fn[o].defaults,a),this.each(function(){!function(r){var l=t.data(r,o);l||(l=new e(r,t.fn.datatable.elementOptions(r,a)),t.data(r,o,l))}(this)}),this)},t.fn.datatable.DataTable=e,t.fn.datatable.elementOptions=function(a,e){return t.metadata?t.extend({},e,t(a).metadata()):e},t.fn.datatable.defaults={debug:!1,id:void 0,title:"",class:"table table-primary table-hover",perPage:12,pagePadding:2,sort:[],filter:{},post:{},buttons:[],sectionHeader:void 0,totalRows:0,rowsName:"rows",currentPage:1,showPagination:!0,showTopPagination:!1,showHeader:!0,showFooter:!1,showFilterRow:!1,filterModal:void 0,allowExport:!1,allowOverflow:!1,allowMultipleSort:!1,allowSaveColumns:!0,toggleColumns:!1,url:"",columns:[],ascending:t("<span></span>").addClass("fa fa-long-arrow-up"),descending:t("<span></span>").addClass("fa fa-long-arrow-down"),rowCallback:void 0,tableCallback:void 0,headerCallback:void 0,footerCallback:void 0,tablePreRender:void 0,autoLoad:!0,tableFade:500}}(window.jQuery);